{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\hinan\\\\todo-app\\\\client\\\\src\\\\component\\\\TaskListWrapper.jsx\",\n  _s = $RefreshSig$();\nimport { TaskContext } from \"../context/TaskContext\";\nimport TaskList from \"./TaskList\";\nimport { useMemo, useState, useContext } from \"react\";\nimport { deleteTaskAPI } from \"../services/TaskService\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function TaskListWrapper({\n  categories,\n  editText,\n  dueDate,\n  removeCategory,\n  categoryFilter\n}) {\n  _s();\n  const {\n    state,\n    dispatch\n  } = useContext(TaskContext);\n  const {\n    tasks,\n    sortBy\n  } = state;\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const filteredTasks = useMemo(() => {\n    const result = Array.isArray(tasks) ? tasks.filter(task => {\n      var _task$text;\n      const text = ((_task$text = task.text) !== null && _task$text !== void 0 ? _task$text : \"\").toLowerCase();\n      const keyword = searchQuery.toLowerCase();\n      const matchesCategory = Array.isArray(categoryFilter) ? categoryFilter.length === 0 || categoryFilter.some(f => {\n        var _task$category$_id, _task$category;\n        const taskCatId = (_task$category$_id = (_task$category = task.category) === null || _task$category === void 0 ? void 0 : _task$category._id) !== null && _task$category$_id !== void 0 ? _task$category$_id : task.category;\n        return String(f._id) === String(taskCatId);\n      }) : true;\n      const matchesKeyword = searchQuery.trim() === \"\" || text.includes(keyword);\n\n      // console.log({\n      //   text,\n      //   keyword,\n      //   matchesCategory,\n      //   matchesKeyword,\n      //   included: matchesCategory && matchesKeyword,\n      // });\n\n      return matchesCategory && matchesKeyword;\n    }) : [];\n    return result;\n  }, [tasks, categoryFilter, searchQuery]);\n  console.log(\"受け取ったWLIST内 tasks:\", tasks);\n  console.log(\"受け取ったWLIST内 categories:\", categories);\n  console.log(\"受け取ったWLIST内 categoryFilter:\", categoryFilter);\n  console.log(\"filteredTasks W:\", filteredTasks);\n  const sortedTasks = useMemo(() => {\n    return [...filteredTasks].sort((a, b) => {\n      switch (sortBy) {\n        case \"deadlineAsc\":\n          return new Date(a.dueDate) - new Date(b.dueDate);\n        case \"deadlineDesc\":\n          return new Date(b.dueDate) - new Date(a.dueDate);\n        case \"priority\":\n          return b.priority - a.priority;\n        case \"createdAtDesc\":\n          return new Date(b.id) - new Date(a.id);\n        default:\n          return 0;\n      }\n    });\n  }, [filteredTasks, sortBy]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"text\",\n      placeholder: \"\\u30AD\\u30FC\\u30EF\\u30FC\\u30C9\\u3067\\u691C\\u7D22\",\n      value: searchQuery,\n      onChange: e => setSearchQuery(e.target.value),\n      className: \"border p-2 rounded mb-2\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n      value: sortBy,\n      onChange: e => dispatch({\n        type: \"SET_SORT\",\n        payload: e.target.value\n      }),\n      children: [/*#__PURE__*/_jsxDEV(\"option\", {\n        value: \"deadlineAsc\",\n        children: \"\\u7DE0\\u5207\\u304C\\u8FD1\\u3044\\u9806\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n        value: \"deadlineDesc\",\n        children: \"\\u7DE0\\u5207\\u304C\\u9060\\u3044\\u9806\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n        value: \"priority\",\n        children: \"\\u512A\\u5148\\u5EA6\\u304C\\u9AD8\\u3044\\u9806\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n        value: \"createdAtDesc\",\n        children: \"\\u4F5C\\u6210\\u65E5\\u304C\\u65B0\\u3057\\u3044\\u9806\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(TaskList, {\n      tasks: sortedTasks,\n      categories: categories,\n      editText: editText,\n      setEditText: text => dispatch({\n        type: \"START_EDITING\",\n        payload: {\n          id: null,\n          text\n        }\n      }),\n      startEditing: id => dispatch({\n        type: \"START_EDITING\",\n        payload: {\n          id\n        }\n      }),\n      toggleComplete: id => dispatch({\n        type: \"TOGGLE_CATEGORY_FILTER\",\n        payload: {\n          id\n        }\n      }),\n      removeCategory: removeCategory,\n      dueDate: dueDate,\n      categoryFilter: categoryFilter\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n_s(TaskListWrapper, \"zIxLo19sPJgad2AVhdyXlgMW3cg=\");\n_c = TaskListWrapper;\nvar _c;\n$RefreshReg$(_c, \"TaskListWrapper\");","map":{"version":3,"names":["TaskContext","TaskList","useMemo","useState","useContext","deleteTaskAPI","jsxDEV","_jsxDEV","Fragment","_Fragment","TaskListWrapper","categories","editText","dueDate","removeCategory","categoryFilter","_s","state","dispatch","tasks","sortBy","searchQuery","setSearchQuery","filteredTasks","result","Array","isArray","filter","task","_task$text","text","toLowerCase","keyword","matchesCategory","length","some","f","_task$category$_id","_task$category","taskCatId","category","_id","String","matchesKeyword","trim","includes","console","log","sortedTasks","sort","a","b","Date","priority","id","children","type","placeholder","value","onChange","e","target","className","fileName","_jsxFileName","lineNumber","columnNumber","payload","setEditText","startEditing","toggleComplete","_c","$RefreshReg$"],"sources":["C:/Users/hinan/todo-app/client/src/component/TaskListWrapper.jsx"],"sourcesContent":["import { TaskContext } from \"../context/TaskContext\"; \r\nimport TaskList from \"./TaskList\";\r\nimport { useMemo, useState ,useContext } from \"react\";\r\nimport { deleteTaskAPI } from \"../services/TaskService\";\r\n\r\nexport default function TaskListWrapper({ categories,editText,dueDate,removeCategory,categoryFilter}) {\r\n  const { state, dispatch } = useContext(TaskContext);\r\n  const { tasks,  sortBy } = state;\r\n  const [searchQuery, setSearchQuery] = useState(\"\");\r\n\r\n  const filteredTasks = useMemo(() => {\r\n    const result = Array.isArray(tasks)\r\n      ?tasks.filter((task) => {\r\n      const text = (task.text ?? \"\").toLowerCase();\r\n      const keyword = searchQuery.toLowerCase();\r\nconst matchesCategory = Array.isArray(categoryFilter)\r\n  ? categoryFilter.length === 0 || \r\n    categoryFilter.some((f) => {\r\n      const taskCatId = task.category?._id ?? task.category;\r\n      return String(f._id) === String(taskCatId);\r\n    })\r\n  : true;\r\n      const matchesKeyword = searchQuery.trim() === \"\" || text.includes(keyword);\r\n  \r\n      // console.log({\r\n      //   text,\r\n      //   keyword,\r\n      //   matchesCategory,\r\n      //   matchesKeyword,\r\n      //   included: matchesCategory && matchesKeyword,\r\n      // });\r\n  \r\n      return matchesCategory && matchesKeyword;\r\n    }):[];\r\n  \r\n    return result;\r\n  }, [tasks, categoryFilter, searchQuery]);\r\n\r\n\r\n  console.log(\"受け取ったWLIST内 tasks:\", tasks);\r\n  console.log(\"受け取ったWLIST内 categories:\", categories);\r\n  console.log(\"受け取ったWLIST内 categoryFilter:\", categoryFilter);\r\n  console.log(\"filteredTasks W:\", filteredTasks);\r\n\r\n  const sortedTasks = useMemo(() => {\r\n    return [...filteredTasks].sort((a, b) => {\r\n      switch (sortBy) {\r\n        case \"deadlineAsc\":\r\n          return new Date(a.dueDate) - new Date(b.dueDate);\r\n        case \"deadlineDesc\":\r\n          return new Date(b.dueDate) - new Date(a.dueDate);\r\n        case \"priority\":\r\n          return b.priority - a.priority;\r\n        case \"createdAtDesc\":\r\n          return new Date(b.id) - new Date(a.id);\r\n        default:\r\n          return 0;\r\n      }\r\n    });\r\n  }, [filteredTasks, sortBy]);\r\n\r\n  return (\r\n    <>\r\n      <input\r\n        type=\"text\"\r\n        placeholder=\"キーワードで検索\"\r\n        value={searchQuery}\r\n        onChange={(e) => setSearchQuery(e.target.value)}\r\n        className=\"border p-2 rounded mb-2\"\r\n      />\r\n      <select\r\n        value={sortBy}\r\n        onChange={(e) =>dispatch({ type: \"SET_SORT\", payload: e.target.value })}\r\n      >\r\n        <option value=\"deadlineAsc\">締切が近い順</option>\r\n        <option value=\"deadlineDesc\">締切が遠い順</option>\r\n        <option value=\"priority\">優先度が高い順</option>\r\n        <option value=\"createdAtDesc\">作成日が新しい順</option>\r\n      </select>\r\n\r\n      <TaskList\r\n        tasks={sortedTasks}\r\n        categories={categories}\r\n        editText={editText}\r\n        setEditText={(text) => dispatch({ type: \"START_EDITING\", payload: { id: null, text } })}\r\n        startEditing={(id) => dispatch({ type: \"START_EDITING\", payload: { id} })}\r\n        toggleComplete={(id) => dispatch({ type: \"TOGGLE_CATEGORY_FILTER\", payload: { id } })}\r\n        removeCategory={removeCategory}\r\n        dueDate={dueDate}\r\n        categoryFilter={categoryFilter}\r\n      />\r\n    </>\r\n  );\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}