{"ast":null,"code":"import{TaskContext}from\"../context/TaskContext\";import TaskList from\"./TaskList\";import{useMemo,useState,useContext}from\"react\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function TaskListWrapper(_ref){let{categories}=_ref;const{state,dispatch}=useContext(TaskContext);const{tasks,categoryFilter,sortBy}=state;const[searchQuery,setSearchQuery]=useState(\"\");const filteredTasks=useMemo(()=>{const result=Array.isArray(tasks)?tasks.filter(task=>{var _task$text;const text=((_task$text=task.text)!==null&&_task$text!==void 0?_task$text:\"\").toLowerCase();const keyword=searchQuery.toLowerCase();const matchesCategory=Array.isArray(categoryFilter)?categoryFilter.length===0||categoryFilter.some(f=>{var _task$category$_id,_task$category;const taskCatId=(_task$category$_id=(_task$category=task.category)===null||_task$category===void 0?void 0:_task$category._id)!==null&&_task$category$_id!==void 0?_task$category$_id:task.category;return String(f)===String(taskCatId);}):true;const matchesKeyword=searchQuery.trim()===\"\"||text.includes(keyword);return matchesCategory&&matchesKeyword;}):[];return result;},[state.tasks,categoryFilter,searchQuery]);console.log(\"受け取ったWLIST内 tasks:\",tasks);console.log(\"受け取ったWLIST内 categories:\",categories);console.log(\"受け取ったWLIST内 categoryFilter:\",categoryFilter);console.log(\"filteredTasks W:\",filteredTasks);const sortedTasks=useMemo(()=>{return[...filteredTasks].sort((a,b)=>{switch(sortBy){case\"deadlineAsc\":return new Date(a.dueDate)-new Date(b.dueDate);case\"deadlineDesc\":return new Date(b.dueDate)-new Date(a.dueDate);case\"priority\":return b.priority-a.priority;case\"createdAtDesc\":return new Date(b.id)-new Date(a.id);default:return 0;}});},[filteredTasks,sortBy]);console.log(\"sortedTasks W:\",sortedTasks);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"\\u30BF\\u30B9\\u30AF\\u540D\\u3067\\u691C\\u7D22\",value:searchQuery,onChange:e=>setSearchQuery(e.target.value),className:\"border p-2 rounded mb-2\"}),/*#__PURE__*/_jsxs(\"select\",{value:sortBy,onChange:e=>dispatch({type:\"SET_SORT\",payload:e.target.value}),children:[/*#__PURE__*/_jsx(\"option\",{value:\"deadlineAsc\",children:\"\\u7DE0\\u5207\\u304C\\u8FD1\\u3044\\u9806\"}),/*#__PURE__*/_jsx(\"option\",{value:\"deadlineDesc\",children:\"\\u7DE0\\u5207\\u304C\\u9060\\u3044\\u9806\"}),/*#__PURE__*/_jsx(\"option\",{value:\"priority\",children:\"\\u512A\\u5148\\u5EA6\\u304C\\u9AD8\\u3044\\u9806\"}),/*#__PURE__*/_jsx(\"option\",{value:\"createdAtDesc\",children:\"\\u4F5C\\u6210\\u65E5\\u304C\\u65B0\\u3057\\u3044\\u9806\"})]}),/*#__PURE__*/_jsx(TaskList,{tasks:sortedTasks,categories:categories,setEditText:text=>dispatch({type:\"START_EDITING\",payload:{id:null,text}})})]});}","map":{"version":3,"names":["TaskContext","TaskList","useMemo","useState","useContext","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","TaskListWrapper","_ref","categories","state","dispatch","tasks","categoryFilter","sortBy","searchQuery","setSearchQuery","filteredTasks","result","Array","isArray","filter","task","_task$text","text","toLowerCase","keyword","matchesCategory","length","some","f","_task$category$_id","_task$category","taskCatId","category","_id","String","matchesKeyword","trim","includes","console","log","sortedTasks","sort","a","b","Date","dueDate","priority","id","children","type","placeholder","value","onChange","e","target","className","payload","setEditText"],"sources":["C:/Users/hinan/todo-app/client/src/component/TaskListWrapper.jsx"],"sourcesContent":["import { TaskContext } from \"../context/TaskContext\"; \r\nimport TaskList from \"./TaskList\";\r\nimport { useMemo, useState ,useContext } from \"react\";\r\n\r\nexport default function TaskListWrapper({categories}) {\r\n  const { state, dispatch } = useContext(TaskContext);\r\n  const { tasks, categoryFilter, sortBy } = state;\r\n  const [searchQuery, setSearchQuery] = useState(\"\");\r\n\r\n  const filteredTasks = useMemo(() => {\r\n    const result = Array.isArray(tasks)\r\n      ?tasks.filter((task) => {\r\n      const text = (task.text ?? \"\").toLowerCase();\r\n      const keyword = searchQuery.toLowerCase();\r\n      const matchesCategory = Array.isArray(categoryFilter) ? categoryFilter.length === 0 || \r\n        categoryFilter.some((f) => {\r\n        const taskCatId = task.category?._id ?? task.category;\r\n        return String(f) === String(taskCatId);\r\n      })\r\n      : true;\r\n      const matchesKeyword = searchQuery.trim() === \"\" || text.includes(keyword);\r\n      return matchesCategory && matchesKeyword;\r\n    }):[];\r\n\r\n    return result;\r\n  }, [state.tasks, categoryFilter, searchQuery]);\r\n\r\n\r\n  console.log(\"受け取ったWLIST内 tasks:\", tasks);\r\n  console.log(\"受け取ったWLIST内 categories:\", categories);\r\n  console.log(\"受け取ったWLIST内 categoryFilter:\", categoryFilter);\r\n  console.log(\"filteredTasks W:\", filteredTasks);\r\n\r\n  const sortedTasks = useMemo(() => {\r\n    return [...filteredTasks].sort((a, b) => {\r\n      switch (sortBy) {\r\n        case \"deadlineAsc\":\r\n          return new Date(a.dueDate) - new Date(b.dueDate);\r\n        case \"deadlineDesc\":\r\n          return new Date(b.dueDate) - new Date(a.dueDate);\r\n        case \"priority\":\r\n          return b.priority - a.priority;\r\n        case \"createdAtDesc\":\r\n          return new Date(b.id) - new Date(a.id);\r\n        default:\r\n          return 0;\r\n      }\r\n    });\r\n  }, [filteredTasks, sortBy]);\r\n  \r\n    console.log(\"sortedTasks W:\", sortedTasks);\r\n  return (\r\n    <>\r\n      <input\r\n        type=\"text\"\r\n        placeholder=\"タスク名で検索\"\r\n        value={searchQuery}\r\n        onChange={(e) => setSearchQuery(e.target.value)}\r\n        className=\"border p-2 rounded mb-2\"\r\n      />\r\n      <select\r\n        value={sortBy}\r\n        onChange={(e) =>dispatch({ type: \"SET_SORT\", payload: e.target.value })}\r\n      >\r\n        <option value=\"deadlineAsc\">締切が近い順</option>\r\n        <option value=\"deadlineDesc\">締切が遠い順</option>\r\n        <option value=\"priority\">優先度が高い順</option>\r\n        <option value=\"createdAtDesc\">作成日が新しい順</option>\r\n      </select>\r\n\r\n      <TaskList\r\n        tasks={sortedTasks}\r\n        categories = {categories}\r\n        setEditText={(text) => dispatch({ type: \"START_EDITING\", payload: { id: null, text } })}\r\n      />\r\n    </>\r\n  );  \r\n}"],"mappings":"AAAA,OAASA,WAAW,KAAQ,wBAAwB,CACpD,MAAO,CAAAC,QAAQ,KAAM,YAAY,CACjC,OAASC,OAAO,CAAEC,QAAQ,CAAEC,UAAU,KAAQ,OAAO,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,CAAAC,QAAA,IAAAC,SAAA,yBAEtD,cAAe,SAAS,CAAAC,eAAeA,CAAAC,IAAA,CAAe,IAAd,CAACC,UAAU,CAAC,CAAAD,IAAA,CAClD,KAAM,CAAEE,KAAK,CAAEC,QAAS,CAAC,CAAGX,UAAU,CAACJ,WAAW,CAAC,CACnD,KAAM,CAAEgB,KAAK,CAAEC,cAAc,CAAEC,MAAO,CAAC,CAAGJ,KAAK,CAC/C,KAAM,CAACK,WAAW,CAAEC,cAAc,CAAC,CAAGjB,QAAQ,CAAC,EAAE,CAAC,CAElD,KAAM,CAAAkB,aAAa,CAAGnB,OAAO,CAAC,IAAM,CAClC,KAAM,CAAAoB,MAAM,CAAGC,KAAK,CAACC,OAAO,CAACR,KAAK,CAAC,CAChCA,KAAK,CAACS,MAAM,CAAEC,IAAI,EAAK,KAAAC,UAAA,CACxB,KAAM,CAAAC,IAAI,CAAG,EAAAD,UAAA,CAACD,IAAI,CAACE,IAAI,UAAAD,UAAA,UAAAA,UAAA,CAAI,EAAE,EAAEE,WAAW,CAAC,CAAC,CAC5C,KAAM,CAAAC,OAAO,CAAGX,WAAW,CAACU,WAAW,CAAC,CAAC,CACzC,KAAM,CAAAE,eAAe,CAAGR,KAAK,CAACC,OAAO,CAACP,cAAc,CAAC,CAAGA,cAAc,CAACe,MAAM,GAAK,CAAC,EACjFf,cAAc,CAACgB,IAAI,CAAEC,CAAC,EAAK,KAAAC,kBAAA,CAAAC,cAAA,CAC3B,KAAM,CAAAC,SAAS,EAAAF,kBAAA,EAAAC,cAAA,CAAGV,IAAI,CAACY,QAAQ,UAAAF,cAAA,iBAAbA,cAAA,CAAeG,GAAG,UAAAJ,kBAAA,UAAAA,kBAAA,CAAIT,IAAI,CAACY,QAAQ,CACrD,MAAO,CAAAE,MAAM,CAACN,CAAC,CAAC,GAAKM,MAAM,CAACH,SAAS,CAAC,CACxC,CAAC,CAAC,CACA,IAAI,CACN,KAAM,CAAAI,cAAc,CAAGtB,WAAW,CAACuB,IAAI,CAAC,CAAC,GAAK,EAAE,EAAId,IAAI,CAACe,QAAQ,CAACb,OAAO,CAAC,CAC1E,MAAO,CAAAC,eAAe,EAAIU,cAAc,CAC1C,CAAC,CAAC,CAAC,EAAE,CAEL,MAAO,CAAAnB,MAAM,CACf,CAAC,CAAE,CAACR,KAAK,CAACE,KAAK,CAAEC,cAAc,CAAEE,WAAW,CAAC,CAAC,CAG9CyB,OAAO,CAACC,GAAG,CAAC,oBAAoB,CAAE7B,KAAK,CAAC,CACxC4B,OAAO,CAACC,GAAG,CAAC,yBAAyB,CAAEhC,UAAU,CAAC,CAClD+B,OAAO,CAACC,GAAG,CAAC,6BAA6B,CAAE5B,cAAc,CAAC,CAC1D2B,OAAO,CAACC,GAAG,CAAC,kBAAkB,CAAExB,aAAa,CAAC,CAE9C,KAAM,CAAAyB,WAAW,CAAG5C,OAAO,CAAC,IAAM,CAChC,MAAO,CAAC,GAAGmB,aAAa,CAAC,CAAC0B,IAAI,CAAC,CAACC,CAAC,CAAEC,CAAC,GAAK,CACvC,OAAQ/B,MAAM,EACZ,IAAK,aAAa,CAChB,MAAO,IAAI,CAAAgC,IAAI,CAACF,CAAC,CAACG,OAAO,CAAC,CAAG,GAAI,CAAAD,IAAI,CAACD,CAAC,CAACE,OAAO,CAAC,CAClD,IAAK,cAAc,CACjB,MAAO,IAAI,CAAAD,IAAI,CAACD,CAAC,CAACE,OAAO,CAAC,CAAG,GAAI,CAAAD,IAAI,CAACF,CAAC,CAACG,OAAO,CAAC,CAClD,IAAK,UAAU,CACb,MAAO,CAAAF,CAAC,CAACG,QAAQ,CAAGJ,CAAC,CAACI,QAAQ,CAChC,IAAK,eAAe,CAClB,MAAO,IAAI,CAAAF,IAAI,CAACD,CAAC,CAACI,EAAE,CAAC,CAAG,GAAI,CAAAH,IAAI,CAACF,CAAC,CAACK,EAAE,CAAC,CACxC,QACE,MAAO,EAAC,CACZ,CACF,CAAC,CAAC,CACJ,CAAC,CAAE,CAAChC,aAAa,CAAEH,MAAM,CAAC,CAAC,CAEzB0B,OAAO,CAACC,GAAG,CAAC,gBAAgB,CAAEC,WAAW,CAAC,CAC5C,mBACEtC,KAAA,CAAAE,SAAA,EAAA4C,QAAA,eACEhD,IAAA,UACEiD,IAAI,CAAC,MAAM,CACXC,WAAW,CAAC,4CAAS,CACrBC,KAAK,CAAEtC,WAAY,CACnBuC,QAAQ,CAAGC,CAAC,EAAKvC,cAAc,CAACuC,CAAC,CAACC,MAAM,CAACH,KAAK,CAAE,CAChDI,SAAS,CAAC,yBAAyB,CACpC,CAAC,cACFrD,KAAA,WACEiD,KAAK,CAAEvC,MAAO,CACdwC,QAAQ,CAAGC,CAAC,EAAI5C,QAAQ,CAAC,CAAEwC,IAAI,CAAE,UAAU,CAAEO,OAAO,CAAEH,CAAC,CAACC,MAAM,CAACH,KAAM,CAAC,CAAE,CAAAH,QAAA,eAExEhD,IAAA,WAAQmD,KAAK,CAAC,aAAa,CAAAH,QAAA,CAAC,sCAAM,CAAQ,CAAC,cAC3ChD,IAAA,WAAQmD,KAAK,CAAC,cAAc,CAAAH,QAAA,CAAC,sCAAM,CAAQ,CAAC,cAC5ChD,IAAA,WAAQmD,KAAK,CAAC,UAAU,CAAAH,QAAA,CAAC,4CAAO,CAAQ,CAAC,cACzChD,IAAA,WAAQmD,KAAK,CAAC,eAAe,CAAAH,QAAA,CAAC,kDAAQ,CAAQ,CAAC,EACzC,CAAC,cAEThD,IAAA,CAACL,QAAQ,EACPe,KAAK,CAAE8B,WAAY,CACnBjC,UAAU,CAAIA,UAAW,CACzBkD,WAAW,CAAGnC,IAAI,EAAKb,QAAQ,CAAC,CAAEwC,IAAI,CAAE,eAAe,CAAEO,OAAO,CAAE,CAAET,EAAE,CAAE,IAAI,CAAEzB,IAAK,CAAE,CAAC,CAAE,CACzF,CAAC,EACF,CAAC,CAEP","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}