{"ast":null,"code":"import{TaskContext}from\"../context/TaskContext\";import TaskList from\"./TaskList\";import{useMemo,useState,useContext}from\"react\";import{deleteTaskAPI}from\"../services/TaskService\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function TaskListWrapper(_ref){let{categories,editText,dueDate,removeCategory}=_ref;const{state,dispatch}=useContext(TaskContext);const{tasks,categoryFilter,sortBy}=state;const[searchQuery,setSearchQuery]=useState(\"\");const filteredTasks=useMemo(()=>{const result=Array.isArray(tasks)?tasks.filter(task=>{var _task$text;const text=((_task$text=task.text)!==null&&_task$text!==void 0?_task$text:\"\").toLowerCase();const keyword=searchQuery.toLowerCase();const matchesCategory=categoryFilter.length===0||categoryFilter.includes(task.category);const matchesKeyword=searchQuery.trim()===\"\"||text.includes(keyword);// console.log({\n//   text,\n//   keyword,\n//   matchesCategory,\n//   matchesKeyword,\n//   included: matchesCategory && matchesKeyword,\n// });\nreturn matchesCategory&&matchesKeyword;}):[];return result;},[tasks,categoryFilter,searchQuery]);console.log(\"filteredTasks W:\",filteredTasks);const sortedTasks=useMemo(()=>{return[...filteredTasks].sort((a,b)=>{switch(sortBy){case\"deadlineAsc\":return new Date(a.dueDate)-new Date(b.dueDate);case\"deadlineDesc\":return new Date(b.dueDate)-new Date(a.dueDate);case\"priority\":return b.priority-a.priority;case\"createdAtDesc\":return new Date(b.id)-new Date(a.id);default:return 0;}});},[filteredTasks,sortBy]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"\\u30AD\\u30FC\\u30EF\\u30FC\\u30C9\\u3067\\u691C\\u7D22\",value:searchQuery,onChange:e=>setSearchQuery(e.target.value),className:\"border p-2 rounded mb-2\"}),/*#__PURE__*/_jsxs(\"select\",{value:sortBy,onChange:e=>dispatch({type:\"SET_SORT\",payload:e.target.value}),children:[/*#__PURE__*/_jsx(\"option\",{value:\"deadlineAsc\",children:\"\\u7DE0\\u5207\\u304C\\u8FD1\\u3044\\u9806\"}),/*#__PURE__*/_jsx(\"option\",{value:\"deadlineDesc\",children:\"\\u7DE0\\u5207\\u304C\\u9060\\u3044\\u9806\"}),/*#__PURE__*/_jsx(\"option\",{value:\"priority\",children:\"\\u512A\\u5148\\u5EA6\\u304C\\u9AD8\\u3044\\u9806\"}),/*#__PURE__*/_jsx(\"option\",{value:\"createdAtDesc\",children:\"\\u4F5C\\u6210\\u65E5\\u304C\\u65B0\\u3057\\u3044\\u9806\"})]}),/*#__PURE__*/_jsx(TaskList,{tasks:sortedTasks,categories:categories,editText:editText,setEditText:text=>dispatch({type:\"START_EDITING\",payload:{id:null,text}}),startEditing:(id,text)=>dispatch({type:\"START_EDITING\",payload:{id}}),toggleComplete:id=>dispatch({type:\"TOGGLE_CATEGORY_FILTER\",payload:{id}}),removeCategory:removeCategory,dueDate:dueDate,categoryFilter:categoryFilter})]});}","map":{"version":3,"names":["TaskContext","TaskList","useMemo","useState","useContext","deleteTaskAPI","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","TaskListWrapper","_ref","categories","editText","dueDate","removeCategory","state","dispatch","tasks","categoryFilter","sortBy","searchQuery","setSearchQuery","filteredTasks","result","Array","isArray","filter","task","_task$text","text","toLowerCase","keyword","matchesCategory","length","includes","category","matchesKeyword","trim","console","log","sortedTasks","sort","a","b","Date","priority","id","children","type","placeholder","value","onChange","e","target","className","payload","setEditText","startEditing","toggleComplete"],"sources":["C:/Users/hinan/todo-app/client/src/component/TaskListWrapper.jsx"],"sourcesContent":["import { TaskContext } from \"../context/TaskContext\"; \r\nimport TaskList from \"./TaskList\";\r\nimport { useMemo, useState ,useContext } from \"react\";\r\nimport { deleteTaskAPI } from \"../services/TaskService\";\r\n\r\nexport default function TaskListWrapper({ categories,editText,dueDate,removeCategory }) {\r\n  const { state, dispatch } = useContext(TaskContext);\r\n  const { tasks, categoryFilter, sortBy } = state;\r\n  const [searchQuery, setSearchQuery] = useState(\"\");\r\n\r\n  const filteredTasks = useMemo(() => {\r\n    const result = Array.isArray(tasks)\r\n      ?tasks.filter((task) => {\r\n      const text = (task.text ?? \"\").toLowerCase();\r\n      const keyword = searchQuery.toLowerCase();\r\n      const matchesCategory = categoryFilter.length === 0 || categoryFilter.includes(task.category);\r\n      const matchesKeyword = searchQuery.trim() === \"\" || text.includes(keyword);\r\n  \r\n      // console.log({\r\n      //   text,\r\n      //   keyword,\r\n      //   matchesCategory,\r\n      //   matchesKeyword,\r\n      //   included: matchesCategory && matchesKeyword,\r\n      // });\r\n  \r\n      return matchesCategory && matchesKeyword;\r\n    }):[];\r\n  \r\n    return result;\r\n  }, [tasks, categoryFilter, searchQuery]);\r\n\r\n\r\n\r\n  console.log(\"filteredTasks W:\", filteredTasks);\r\n\r\n  const sortedTasks = useMemo(() => {\r\n    return [...filteredTasks].sort((a, b) => {\r\n      switch (sortBy) {\r\n        case \"deadlineAsc\":\r\n          return new Date(a.dueDate) - new Date(b.dueDate);\r\n        case \"deadlineDesc\":\r\n          return new Date(b.dueDate) - new Date(a.dueDate);\r\n        case \"priority\":\r\n          return b.priority - a.priority;\r\n        case \"createdAtDesc\":\r\n          return new Date(b.id) - new Date(a.id);\r\n        default:\r\n          return 0;\r\n      }\r\n    });\r\n  }, [filteredTasks, sortBy]);\r\n\r\n  return (\r\n    <>\r\n      <input\r\n        type=\"text\"\r\n        placeholder=\"キーワードで検索\"\r\n        value={searchQuery}\r\n        onChange={(e) => setSearchQuery(e.target.value)}\r\n        className=\"border p-2 rounded mb-2\"\r\n      />\r\n      <select\r\n        value={sortBy}\r\n        onChange={(e) =>dispatch({ type: \"SET_SORT\", payload: e.target.value })}\r\n      >\r\n        <option value=\"deadlineAsc\">締切が近い順</option>\r\n        <option value=\"deadlineDesc\">締切が遠い順</option>\r\n        <option value=\"priority\">優先度が高い順</option>\r\n        <option value=\"createdAtDesc\">作成日が新しい順</option>\r\n      </select>\r\n\r\n      <TaskList\r\n        tasks={sortedTasks}\r\n        categories={categories}\r\n        editText={editText}\r\n        setEditText={(text) => dispatch({ type: \"START_EDITING\", payload: { id: null, text } })}\r\n        startEditing={(id, text) => dispatch({ type: \"START_EDITING\", payload: { id} })}\r\n        toggleComplete={(id) => dispatch({ type: \"TOGGLE_CATEGORY_FILTER\", payload: { id } })}\r\n        removeCategory={removeCategory}\r\n        dueDate={dueDate}\r\n        categoryFilter={categoryFilter}\r\n      />\r\n    </>\r\n  );\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}