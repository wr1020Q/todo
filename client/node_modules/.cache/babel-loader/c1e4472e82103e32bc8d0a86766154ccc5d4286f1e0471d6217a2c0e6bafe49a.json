{"ast":null,"code":"import cookieUtils from \"@bundled-es-modules/cookie\";\nimport { cookieStore } from '../cookieStore.mjs';\nfunction parseCookies(input) {\n  const parsedCookies = cookieUtils.parse(input);\n  const cookies = {};\n  for (const cookieName in parsedCookies) {\n    if (typeof parsedCookies[cookieName] !== \"undefined\") {\n      cookies[cookieName] = parsedCookies[cookieName];\n    }\n  }\n  return cookies;\n}\nfunction getAllDocumentCookies() {\n  return parseCookies(document.cookie);\n}\nfunction getDocumentCookies(request) {\n  if (typeof document === \"undefined\" || typeof location === \"undefined\") {\n    return {};\n  }\n  switch (request.credentials) {\n    case \"same-origin\":\n      {\n        const requestUrl = new URL(request.url);\n        return location.origin === requestUrl.origin ? getAllDocumentCookies() : {};\n      }\n    case \"include\":\n      {\n        return getAllDocumentCookies();\n      }\n    default:\n      {\n        return {};\n      }\n  }\n}\nfunction getAllRequestCookies(request) {\n  const requestCookieHeader = request.headers.get(\"cookie\");\n  const cookiesFromHeaders = requestCookieHeader ? parseCookies(requestCookieHeader) : {};\n  const cookiesFromDocument = getDocumentCookies(request);\n  for (const name in cookiesFromDocument) {\n    request.headers.append(\"cookie\", cookieUtils.serialize(name, cookiesFromDocument[name]));\n  }\n  const cookiesFromStore = cookieStore.getCookiesSync(request.url);\n  const storedCookiesObject = Object.fromEntries(cookiesFromStore.map(cookie => [cookie.key, cookie.value]));\n  for (const cookie of cookiesFromStore) {\n    request.headers.append(\"cookie\", cookie.toString());\n  }\n  return {\n    ...cookiesFromDocument,\n    ...storedCookiesObject,\n    ...cookiesFromHeaders\n  };\n}\nexport { getAllRequestCookies };","map":{"version":3,"names":["cookieUtils","cookieStore","parseCookies","input","parsedCookies","parse","cookies","cookieName","getAllDocumentCookies","document","cookie","getDocumentCookies","request","location","credentials","requestUrl","URL","url","origin","getAllRequestCookies","requestCookieHeader","headers","get","cookiesFromHeaders","cookiesFromDocument","name","append","serialize","cookiesFromStore","getCookiesSync","storedCookiesObject","Object","fromEntries","map","key","value","toString"],"sources":["C:\\Users\\hinan\\todo-app\\client\\node_modules\\msw\\src\\core\\utils\\request\\getRequestCookies.ts"],"sourcesContent":["import cookieUtils from '@bundled-es-modules/cookie'\nimport { cookieStore } from '../cookieStore'\n\nfunction parseCookies(input: string): Record<string, string> {\n  const parsedCookies = cookieUtils.parse(input)\n  const cookies: Record<string, string> = {}\n\n  for (const cookieName in parsedCookies) {\n    if (typeof parsedCookies[cookieName] !== 'undefined') {\n      cookies[cookieName] = parsedCookies[cookieName]\n    }\n  }\n\n  return cookies\n}\n\nfunction getAllDocumentCookies() {\n  return parseCookies(document.cookie)\n}\n\nfunction getDocumentCookies(request: Request): Record<string, string> {\n  if (typeof document === 'undefined' || typeof location === 'undefined') {\n    return {}\n  }\n\n  switch (request.credentials) {\n    case 'same-origin': {\n      const requestUrl = new URL(request.url)\n\n      // Return document cookies only when requested a resource\n      // from the same origin as the current document.\n      return location.origin === requestUrl.origin\n        ? getAllDocumentCookies()\n        : {}\n    }\n\n    case 'include': {\n      // Return all document cookies.\n      return getAllDocumentCookies()\n    }\n\n    default: {\n      return {}\n    }\n  }\n}\n\nexport function getAllRequestCookies(request: Request): Record<string, string> {\n  /**\n   * @note While the \"cookie\" header is a forbidden header field\n   * in the browser, you can read it in Node.js. We need to respect\n   * it for mocking in Node.js.\n   */\n  const requestCookieHeader = request.headers.get('cookie')\n  const cookiesFromHeaders = requestCookieHeader\n    ? parseCookies(requestCookieHeader)\n    : {}\n\n  const cookiesFromDocument = getDocumentCookies(request)\n\n  // Forward the document cookies to the request headers.\n  for (const name in cookiesFromDocument) {\n    request.headers.append(\n      'cookie',\n      cookieUtils.serialize(name, cookiesFromDocument[name]),\n    )\n  }\n\n  const cookiesFromStore = cookieStore.getCookiesSync(request.url)\n  const storedCookiesObject = Object.fromEntries(\n    cookiesFromStore.map((cookie) => [cookie.key, cookie.value]),\n  )\n\n  // Forward the raw stored cookies to request headers\n  // so they contain metadata like \"expires\", \"secure\", etc.\n  for (const cookie of cookiesFromStore) {\n    request.headers.append('cookie', cookie.toString())\n  }\n\n  return {\n    ...cookiesFromDocument,\n    ...storedCookiesObject,\n    ...cookiesFromHeaders,\n  }\n}\n"],"mappings":"AAAA,OAAOA,WAAA,MAAiB;AACxB,SAASC,WAAA,QAAmB;AAE5B,SAASC,aAAaC,KAAA,EAAuC;EAC3D,MAAMC,aAAA,GAAgBJ,WAAA,CAAYK,KAAA,CAAMF,KAAK;EAC7C,MAAMG,OAAA,GAAkC,CAAC;EAEzC,WAAWC,UAAA,IAAcH,aAAA,EAAe;IACtC,IAAI,OAAOA,aAAA,CAAcG,UAAU,MAAM,aAAa;MACpDD,OAAA,CAAQC,UAAU,IAAIH,aAAA,CAAcG,UAAU;IAChD;EACF;EAEA,OAAOD,OAAA;AACT;AAEA,SAASE,sBAAA,EAAwB;EAC/B,OAAON,YAAA,CAAaO,QAAA,CAASC,MAAM;AACrC;AAEA,SAASC,mBAAmBC,OAAA,EAA0C;EACpE,IAAI,OAAOH,QAAA,KAAa,eAAe,OAAOI,QAAA,KAAa,aAAa;IACtE,OAAO,CAAC;EACV;EAEA,QAAQD,OAAA,CAAQE,WAAA;IACd,KAAK;MAAe;QAClB,MAAMC,UAAA,GAAa,IAAIC,GAAA,CAAIJ,OAAA,CAAQK,GAAG;QAItC,OAAOJ,QAAA,CAASK,MAAA,KAAWH,UAAA,CAAWG,MAAA,GAClCV,qBAAA,CAAsB,IACtB,CAAC;MACP;IAEA,KAAK;MAAW;QAEd,OAAOA,qBAAA,CAAsB;MAC/B;IAEA;MAAS;QACP,OAAO,CAAC;MACV;EACF;AACF;AAEO,SAASW,qBAAqBP,OAAA,EAA0C;EAM7E,MAAMQ,mBAAA,GAAsBR,OAAA,CAAQS,OAAA,CAAQC,GAAA,CAAI,QAAQ;EACxD,MAAMC,kBAAA,GAAqBH,mBAAA,GACvBlB,YAAA,CAAakB,mBAAmB,IAChC,CAAC;EAEL,MAAMI,mBAAA,GAAsBb,kBAAA,CAAmBC,OAAO;EAGtD,WAAWa,IAAA,IAAQD,mBAAA,EAAqB;IACtCZ,OAAA,CAAQS,OAAA,CAAQK,MAAA,CACd,UACA1B,WAAA,CAAY2B,SAAA,CAAUF,IAAA,EAAMD,mBAAA,CAAoBC,IAAI,CAAC,CACvD;EACF;EAEA,MAAMG,gBAAA,GAAmB3B,WAAA,CAAY4B,cAAA,CAAejB,OAAA,CAAQK,GAAG;EAC/D,MAAMa,mBAAA,GAAsBC,MAAA,CAAOC,WAAA,CACjCJ,gBAAA,CAAiBK,GAAA,CAAKvB,MAAA,IAAW,CAACA,MAAA,CAAOwB,GAAA,EAAKxB,MAAA,CAAOyB,KAAK,CAAC,CAC7D;EAIA,WAAWzB,MAAA,IAAUkB,gBAAA,EAAkB;IACrChB,OAAA,CAAQS,OAAA,CAAQK,MAAA,CAAO,UAAUhB,MAAA,CAAO0B,QAAA,CAAS,CAAC;EACpD;EAEA,OAAO;IACL,GAAGZ,mBAAA;IACH,GAAGM,mBAAA;IACH,GAAGP;EACL;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}