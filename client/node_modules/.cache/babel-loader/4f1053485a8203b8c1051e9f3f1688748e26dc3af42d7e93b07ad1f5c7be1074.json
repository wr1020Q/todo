{"ast":null,"code":"import{useForm}from'react-hook-form';import{yupResolver}from'@hookform/resolvers/yup';import{addTaskSchema}from'../utils/schema';import{addTaskAPI}from'../services/TaskService';import{showSuccess,showError}from\"../utils/toast\";import{useContext,useState}from\"react\";import{TaskContext}from\"../context/TaskContext\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function TaskForm(_ref){let{categories}=_ref;const{state,dispatch}=useContext(TaskContext);const{dueDate}=state;const[task,setTask]=useState(\"\");const[priority,setPriority]=useState(2);const[selectedCategory,setSelectedCategory]=useState(\"\");const{register,handleSubmit,formState:{errors}}=useForm({resolver:yupResolver(addTaskSchema)});const onSubmit=async data=>{console.log('送信データ:',data);await handleAddTask();};const onError=errors=>console.log(errors);const handleAddTask=async()=>{try{console.log(\"handleAddTask\",selectedCategory);const newTask={text:task,priority,category:selectedCategory,dueDate};const createdTask=await addTaskAPI(newTask);console.log(\"handleAddTask返されたタスク\",createdTask.data);dispatch({type:\"ADD_TASK\",payload:createdTask.data});setTask(\"\");setPriority(2);setSelectedCategory(\"\");dispatch({type:\"SET_DUE_DATE\",payload:\"\"});showSuccess(\"タスクを新しく追加しました\");}catch(e){showError(\"タスクを追加できませんでした\");}};return/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit(onSubmit,onError),children:[/*#__PURE__*/_jsx(\"input\",{...register('text'),type:\"text\",value:task!==null&&task!==void 0?task:\"\",onChange:e=>setTask(e.target.value),className:\"border p-2 flex-grow rounded-l\",placeholder:\"\\u30BF\\u30B9\\u30AF\\u3092\\u5165\\u529B...\"}),errors.text&&/*#__PURE__*/_jsx(\"p\",{style:{color:'red'},children:errors.text.message}),/*#__PURE__*/_jsxs(\"select\",{...register('priority'),value:priority!==null&&priority!==void 0?priority:\"\",onChange:e=>setPriority(Number(e.target.value)),className:\"border p-2 rounded\",children:[/*#__PURE__*/_jsx(\"option\",{value:1,children:\"\\u9AD8\"},\"1\"),/*#__PURE__*/_jsx(\"option\",{value:2,children:\"\\u4E2D\"},\"2\"),/*#__PURE__*/_jsx(\"option\",{value:3,children:\"\\u4F4E\"},\"3\")]}),errors.priority&&/*#__PURE__*/_jsx(\"p\",{style:{color:'red'},children:errors.priority.message}),/*#__PURE__*/_jsxs(\"select\",{...register('category'),value:selectedCategory!==null&&selectedCategory!==void 0?selectedCategory:\"\",onChange:e=>setSelectedCategory(e.target.value),className:\"border p-2 rounded\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"\\u30AB\\u30C6\\u30B4\\u30EA\\u3092\\u9078\\u629E\\u3057\\u3066\\u304F\\u3060\\u3055\\u3044\"}),(categories!==null&&categories!==void 0?categories:[]).map(cat=>/*#__PURE__*/_jsx(\"option\",{value:cat._id,children:cat.title},cat._id))]}),errors.category&&/*#__PURE__*/_jsx(\"p\",{style:{color:'red'},children:errors.category.message}),/*#__PURE__*/_jsx(\"input\",{...register('dueDate'),type:\"date\",value:dueDate!==null&&dueDate!==void 0?dueDate:\"\",onChange:e=>dispatch({type:\"SET_DUE_DATE\",payload:e.target.value}),className:\"border p-2 rounded\"}),errors.dueDate&&/*#__PURE__*/_jsx(\"p\",{style:{color:'red'},children:errors.dueDate.message}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"bg-blue-500 text-white p-2 rounded-r\",children:\"\\u8FFD\\u52A0\"})]});}","map":{"version":3,"names":["useForm","yupResolver","addTaskSchema","addTaskAPI","showSuccess","showError","useContext","useState","TaskContext","jsx","_jsx","jsxs","_jsxs","TaskForm","_ref","categories","state","dispatch","dueDate","task","setTask","priority","setPriority","selectedCategory","setSelectedCategory","register","handleSubmit","formState","errors","resolver","onSubmit","data","console","log","handleAddTask","onError","newTask","text","category","createdTask","type","payload","e","children","value","onChange","target","className","placeholder","style","color","message","Number","map","cat","_id","title"],"sources":["C:/Users/hinan/todo-app/client/src/component/TaskForm.jsx"],"sourcesContent":["import { useForm } from 'react-hook-form';\r\nimport { yupResolver } from '@hookform/resolvers/yup';\r\nimport { addTaskSchema } from '../utils/schema';\r\nimport { addTaskAPI} from '../services/TaskService';\r\nimport {showSuccess,showError} from \"../utils/toast\";\r\nimport { useContext,useState } from \"react\";\r\nimport { TaskContext } from \"../context/TaskContext\";\r\n\r\nexport default function TaskForm({ categories}) {\r\n    const { state, dispatch } = useContext(TaskContext);\r\n    const { dueDate } = state;\r\n    const [task, setTask] = useState(\"\");\r\n    const [priority, setPriority] = useState(2);\r\n    const [selectedCategory, setSelectedCategory] = useState(\"\");\r\n    const {\r\n            register,\r\n            handleSubmit,\r\n            formState: { errors },\r\n            } = useForm({  resolver: yupResolver(addTaskSchema),});\r\n\r\n    const onSubmit = async (data) => {\r\n        console.log('送信データ:', data);\r\n        await handleAddTask();\r\n    };\r\n\r\n    const onError = (errors) => console.log(errors);\r\n\r\n    const handleAddTask = async () => {\r\n      try{\r\n        console.log(\"handleAddTask\",selectedCategory)\r\n        const newTask = {\r\n          text: task,\r\n          priority,\r\n          category: selectedCategory ,\r\n          dueDate\r\n        };\r\n  \r\n        const createdTask= await addTaskAPI(newTask);\r\n        console.log(\"handleAddTask返されたタスク\",createdTask.data)\r\n        dispatch({ type: \"ADD_TASK\",payload:  createdTask.data });\r\n        setTask(\"\");\r\n        setPriority(2);\r\n        setSelectedCategory(\"\");\r\n        dispatch({ type: \"SET_DUE_DATE\", payload: \"\" });\r\n        showSuccess(\"タスクを新しく追加しました\")\r\n      }catch(e){\r\n        showError(\"タスクを追加できませんでした\")\r\n      }\r\n    };\r\n      return (\r\n      <form onSubmit={handleSubmit(onSubmit,onError)}>\r\n        <input\r\n          {...register('text')} \r\n          type=\"text\" \r\n          value={task ?? \"\"} \r\n          onChange={(e) => setTask(e.target.value)}\r\n          className=\"border p-2 flex-grow rounded-l\"\r\n          placeholder=\"タスクを入力...\"\r\n        />\r\n        {errors.text && <p style={{ color: 'red' }}>{errors.text.message}</p>}\r\n\r\n        <select\r\n          {...register('priority')}  \r\n          value={priority ?? \"\"} \r\n          onChange={(e)=>setPriority(Number(e.target.value))}  \r\n          className=\"border p-2 rounded\"\r\n        >\r\n          <option key=\"1\" value={1}>高</option>\r\n          <option key=\"2\" value={2}>中</option>\r\n          <option key=\"3\" value={3}>低</option>\r\n        </select>\r\n        {errors.priority && <p style={{ color: 'red' }}>{errors.priority.message}</p>}\r\n\r\n        <select \r\n          {...register('category')} \r\n          value={selectedCategory ?? \"\"} \r\n          onChange={(e) => setSelectedCategory(e.target.value)} \r\n          className=\"border p-2 rounded\"\r\n        >\r\n          <option value=\"\">カテゴリを選択してください</option>\r\n          {(categories ?? []).map((cat) => (\r\n          <option key={cat._id} value={cat._id}>{cat.title}</option>))}\r\n        </select>\r\n        {errors.category && <p style={{ color: 'red' }}>{errors.category.message}</p>}\r\n        \r\n        <input\r\n          {...register('dueDate')}\r\n            type=\"date\"\r\n            value={dueDate ?? \"\"}\r\n            onChange={(e) => dispatch({ type: \"SET_DUE_DATE\", payload: e.target.value })}\r\n            className=\"border p-2 rounded\"\r\n        />\r\n        {errors.dueDate && <p style={{ color: 'red' }}>{errors.dueDate.message}</p>}\r\n\r\n        <button type=\"submit\"  className=\"bg-blue-500 text-white p-2 rounded-r\">\r\n          追加\r\n        </button>\r\n      </form>\r\n      )\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}